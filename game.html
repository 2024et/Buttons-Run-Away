<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ネタサイト</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="icon.ico">
</head>
<body>
    <h1>アンケート</h1>
    <p>以下の簡単なアンケートにご協力ください。</p>
    <form action="" method="post" class="survey">
        <h2>開発者(Ebata)は普段から常にとても優しい性格で、相手を気遣い、尊敬できる人である。</h2>
    
        <input type="button" name="yes" id="yes" class="btn yes-btn" value="とてもそう思う">
        <input type="button" name="no" id="no" class="btn no-btn" value="そうは思わない">
    </form>
    
    
    <script>
    //計測開始
    const startTime = Date.now(); 
    
    //「とてもそう思う」(yes)が押されたときの処理
    //yes.htmlへ遷移
    document.getElementById("yes").addEventListener("click", () => {
      window.location.href = "yes.html";
    });
    
    //「そうは思わない」(no)にマウスが近づいた時の処理    
    //画面表示範囲内でx座標・y座標をランダムで取得しボタンを移動させる
    document.getElementById("no").addEventListener("mouseover", () => {
      const x = Math.random() * (window.innerWidth - 150);
      const y = Math.random() * (window.innerHeight - 50);
  
      const noBtn = document.getElementById("no");
      noBtn.style.position = "absolute";
      noBtn.style.left = x + "px";
      noBtn.style.top = y + "px";
    });

    //「そうは思わない」(no)が押されたときの処理
    //計測時間をlocalStorageに保存し、画面を遷移
    //画面サイズが999以下の場合、不正行為として検知
    document.getElementById("no").addEventListener("click", () => {
      const endTime = Date.now();
      const elapsedSec = ((endTime - startTime) / 1000).toFixed(2);

      localStorage.setItem("elapsedTime", elapsedSec);

      if (window.innerWidth <= 999) {
          window.location.href = "cheat.php";
      }else{
        window.location.href = "result.php";
      }
    });
    
    /******************************************************
    //////////////////【不正行為検知】//////////////////////
    ******************************************************/

    //F12の使用禁止
    document.addEventListener("keydown", function (e) {
      if (
        e.key === "F12" ||
        (e.ctrlKey && e.shiftKey && (e.key === "I" || e.key === "J")) ||
        (e.ctrlKey && e.key === "U")
      ) {
        e.preventDefault();
        window.location.href = "cheat.php";
      }
    });

    //F5の使用禁止
    document.addEventListener("keydown", function (e) {
      if (
        e.key === "F5" ||
        (e.ctrlKey && e.shiftKey && (e.key === "I" || e.key === "J")) ||
        (e.ctrlKey && e.key === "U")
      ) {
        e.preventDefault();
        window.location.href = "cheat.php";
      }
    });
    
    //Tabの使用禁止
    document.addEventListener("keydown", function (e) {
      if (
        e.key === "Tab" ||
        (e.ctrlKey && e.shiftKey && (e.key === "I" || e.key === "J")) ||
        (e.ctrlKey && e.key === "U")
      ) {
        e.preventDefault();
        window.location.href = "cheat.php";
      }
    });

    //Rの使用禁止
    document.addEventListener("keydown", function (e) {
    if (e.key === "r" || e.key === "R") {
      e.preventDefault();
      window.location.href = "cheat.php";
      return;
    }

    if (
        (e.ctrlKey && e.shiftKey && (e.key === "I" || e.key === "J")) ||
        (e.ctrlKey && e.key === "U")
      ) {
        e.preventDefault();
        window.location.href = "cheat.php";
      }
    });
    

    //999以下の画面サイズでの閲覧を禁止
    if (window.innerWidth <= 999) {
      window.location.href = "cheat.php";
    }

    //右クリックの使用禁止
    document.addEventListener('contextmenu', function(e) {
      e.preventDefault(); 
    });
    </script>
  </body>
</html>